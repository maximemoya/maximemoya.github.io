<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MaxPage</title>
</head>
<body>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/seedrandom/3.0.5/seedrandom.min.js"></script> -->
    <script>

        !function(f,a,c){
            var s,l=256,p="random",d=c.pow(l,6),g=c.pow(2,52),y=2*g,h=l-1;
            function n(n,t,r){
                function e(){for(var n=u.g(6),t=d,r=0;n<g;)n=(n+r)*l,t*=l,r=u.g(1);for(;y<=n;)n/=2,t/=2,r>>>=1;return(n+r)/t}var o=[],i=j(function n(t,r){var e,o=[],i=typeof t;if(r&&"object"==i)for(e in t)try{o.push(n(t[e],r-1))}catch(n){}return o.length?o:"string"==i?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[n,S(a)]:null==n?function(){try{var n;return s&&(n=s.randomBytes)?n=n(l):(n=new Uint8Array(l),(f.crypto||f.msCrypto).getRandomValues(n)),S(n)}catch(n){var t=f.navigator,r=t&&t.plugins;return[+new Date,f,r,f.screen,S(a)]}}():n,3),o),u=new m(o);return e.int32=function(){return 0|u.g(4)},e.quick=function(){return u.g(4)/4294967296},e.double=e,j(S(u.S),a),(t.pass||r||function(n,t,r,e){return e&&(e.S&&v(e,u),n.state=function(){return v(u,{})}),r?(c[p]=n,t):n})(e,i,"global"in t?t.global:this==c,t.state)
            }function m(n){var t,r=n.length,u=this,e=0,o=u.i=u.j=0,i=u.S=[];for(r||(n=[r++]);e<l;)i[e]=e++;for(e=0;e<l;e++)i[e]=i[o=h&o+n[e%r]+(t=i[e])],i[o]=t;(u.g=function(n){for(var t,r=0,e=u.i,o=u.j,i=u.S;n--;)t=i[e=h&e+1],r=r*l+i[h&(i[e]=i[o=h&o+t])+(i[o]=t)];return u.i=e,u.j=o,r})(l)}function v(n,t){return t.i=n.i,t.j=n.j,t.S=n.S.slice(),t}function j(n,t){for(var r,e=n+"",o=0;o<e.length;)t[h&o]=h&(r^=19*t[h&o])+e.charCodeAt(o++);return S(t)}function S(n){return String.fromCharCode.apply(0,n)}if(j(c.random(),a),"object"==typeof module&&module.exports){module.exports=n;try{s=require("crypto")}catch(n){}}else"function"==typeof define&&define.amd?define(function(){return n}):c["seed"+p]=n
        }("undefined"!=typeof self?self:this,[],Math);

        async function sha512(str) {
        const encoder = new TextEncoder();
        const data = encoder.encode(str);
        const hashBuffer = await crypto.subtle.digest("SHA-512", data);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        const hashHex = hashArray.map(byte => byte.toString(16).padStart(2, "0")).join("");
        return hashHex;
        }

        function generateRandomNumber(seed) {
        const rng = new Math.seedrandom(seed);
        return rng();
        }

        const array = ["aL1$", "2T*c", "Xb3%", "$Sa2", "1$Xb", "3%aL", "*c2T", "1$aL", "6Fd*","d*2T"]
        function changePassword() {
            var keyField = document.getElementById("keyPass");
            var passwordField = document.getElementById("password");
            var newPassword = ""
            for (let index = 0; index < passwordField.value.length; index++) {
                newPassword += passwordField.value[index] + array[passwordField.value.charCodeAt(index) % array.length];
            }
            const inputString = newPassword;
            console.log("key: ", keyField.value)
            console.log("initial-password: ", passwordField.value)
            console.log("array used: ", array)
            console.log("text mixed with array: ", inputString)
            sha512(inputString)
            .then(hash => {
                const salt = (array[newPassword.charCodeAt(0) % array.length] !== undefined)? array[newPassword.charCodeAt(0) % array.length] : "Emp$y"
                passwordField.value = hash.slice(0,10) + salt + hash.slice(10,60)
                console.log("hashresult: ", hash)
                console.log(`final result by truncate hash and introducing '${salt}'`)
                console.log("final result: ", passwordField.value)
            })
            .catch(error => console.error(error));  
            
            const seed = keyField.value;
            const randomNumber = generateRandomNumber(seed);
            console.log(`randomnumber with seed(${seed})`, randomNumber);
        }
    </script>
    <div>
        <h3>
            <a href="index.html">go to IndexPage</a>
        </h3>
    </div>
    <div>
        <h1>
            Welcome to MaxPage
        </h1>
    </div>
    <div>
        <h2>Password Transformer :</h2>
        <!-- <form> -->
        <label for="keyPass">Enter a key:</label>
        <input type="text" id="keyPass" name="keyPass" required size="20">
        <br>
        <br>
        <label for="password">Enter Password:</label>
        <input type="text" id="password" name="password" required size="80">
        <br>
        <br>
        <button type="button" onclick="changePassword()">TRANSFORM Password</button>
        <!-- </form> -->
    </div>
</body>
</html>